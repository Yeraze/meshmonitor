{
  "vulnerabilities": [
    {
      "ID": "AUTH-VULN-01",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "POST /api/auth/login",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/routes/authRoutes.ts:265-269",
      "missing_defense": "No session.regenerate() called after successful local authentication. Session ID is reused before and after authentication.",
      "exploitation_hypothesis": "An attacker can force a known session ID on a victim via XSS on subdomain or network injection, then hijack the authenticated session after the victim logs in with valid credentials.",
      "suggested_exploit_technique": "session_fixation",
      "confidence": "High",
      "notes": "Session ID must be obtained before victim authentication. Can be tested by capturing session cookie before login, authenticating, and verifying the same session ID is still valid. Also affects MFA flow (AUTH-VULN-02) and OIDC callback (AUTH-VULN-03)."
    },
    {
      "ID": "AUTH-VULN-02",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "POST /api/auth/verify-mfa",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/routes/authRoutes.ts:370-374",
      "missing_defense": "No session.regenerate() called after successful MFA verification. Session ID established during login is reused after MFA completion.",
      "exploitation_hypothesis": "An attacker can force a known session ID on a victim during the login phase, wait for the victim to complete MFA verification, then hijack the fully authenticated session.",
      "suggested_exploit_technique": "session_fixation",
      "confidence": "High",
      "notes": "Requires victim to have MFA enabled. Attack succeeds even if MFA is properly verified because session ID is not rotated. Can combine with AUTH-VULN-01 for complete session fixation attack flow."
    },
    {
      "ID": "AUTH-VULN-03",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "GET /api/auth/oidc/callback",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/routes/authRoutes.ts:525-529",
      "missing_defense": "No session.regenerate() called after successful OIDC authentication. Session ID initiated before OIDC flow is reused after external authentication completes.",
      "exploitation_hypothesis": "An attacker can force a known session ID on a victim before OIDC login initiation, wait for the victim to authenticate with the external OIDC provider, then hijack the authenticated session when control returns to the application.",
      "suggested_exploit_technique": "session_fixation",
      "confidence": "High",
      "notes": "Affects SSO/OIDC authentication flow. OIDC state/nonce validation is correct but does not prevent session fixation. Session established during /api/auth/oidc/login carries through to post-authentication state."
    },
    {
      "ID": "AUTH-VULN-04",
      "vulnerability_type": "Transport_Exposure",
      "externally_exploitable": true,
      "source_endpoint": "POST /api/auth/login",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/routes/authRoutes.ts:211-291",
      "missing_defense": "No Cache-Control: no-store headers on authentication endpoints. Responses may be cached by browsers or proxies.",
      "exploitation_hypothesis": "An attacker with access to browser cache, shared computer, or proxy logs can retrieve cached authentication responses containing session cookies and user data, allowing unauthorized access to the account.",
      "suggested_exploit_technique": "credential_theft",
      "confidence": "Medium",
      "notes": "Affects all authentication endpoints: POST /api/auth/login, POST /api/auth/verify-mfa, GET /api/auth/oidc/callback, GET /api/auth/status. Impact depends on browser/proxy caching behavior. Modern browsers may not cache POST responses by default, but GET endpoints (status, OIDC callback) are vulnerable. No HSTS by default also allows protocol downgrade attacks (COOKIE_SECURE=false default)."
    },
    {
      "ID": "AUTH-VULN-05",
      "vulnerability_type": "Weak_Credentials",
      "externally_exploitable": true,
      "source_endpoint": "POST /api/auth/login",
      "vulnerable_code_location": "/repos/meshmonitor/src/services/database.ts:8551",
      "missing_defense": "Hardcoded default admin password 'changeme' created on first run without forcing immediate password change.",
      "exploitation_hypothesis": "An attacker can successfully log into the admin account using the well-known default credentials (username: admin, password: changeme) if the administrator failed to change the password after initial deployment.",
      "suggested_exploit_technique": "credential_stuffing",
      "confidence": "Medium",
      "notes": "Only exploitable if admin has not changed default password. GET /api/auth/check-default-password endpoint reveals whether default password is still in use (returns {usingDefaultPassword: true}). Can be detected without authentication. Rate limiting (5 attempts per 15 minutes) slows but does not prevent exploitation."
    }
  ]
}