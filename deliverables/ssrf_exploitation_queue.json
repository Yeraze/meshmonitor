{
  "vulnerabilities": [
    {
      "ID": "SSRF-VULN-01",
      "vulnerability_type": "URL_Manipulation",
      "externally_exploitable": true,
      "source_endpoint": "GET /api/link-preview",
      "vulnerable_parameter": "url (query parameter)",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/routes/linkPreviewRoutes.ts:96",
      "missing_defense": "No internal IP address blocking or cloud metadata endpoint restrictions. Protocol allowlist exists (HTTP/HTTPS) but no hostname/IP validation.",
      "exploitation_hypothesis": "An attacker can access internal services and cloud metadata endpoints by providing internal URLs or the cloud metadata IP (169.254.169.254). The endpoint returns full HTTP responses including status codes, headers, and body content, enabling non-blind SSRF exploitation for data exfiltration and service enumeration.",
      "suggested_exploit_technique": "cloud_metadata_retrieval",
      "confidence": "High",
      "notes": "Anonymous access (no authentication required via optionalAuth middleware). Returns full response body for HTML content including parsed metadata (title, description, images). 5-second timeout limits but doesn't prevent exploitation. Primary targets: AWS metadata (http://169.254.169.254/latest/meta-data/iam/security-credentials/), internal services (http://127.0.0.1:6379 for Redis, http://127.0.0.1:5432 for PostgreSQL), private network hosts (http://192.168.x.x, http://10.x.x.x). Non-blind SSRF makes this highly exploitable for reconnaissance and data theft."
    },
    {
      "ID": "SSRF-VULN-02",
      "vulnerability_type": "URL_Manipulation",
      "externally_exploitable": true,
      "source_endpoint": "POST /api/http/test",
      "vulnerable_parameter": "url (POST body parameter)",
      "vulnerable_code_location": "/repos/meshmonitor/src/server/server.ts:8965",
      "missing_defense": "No internal IP address blocking or cloud metadata endpoint restrictions. Protocol allowlist exists (HTTP/HTTPS) but no hostname/IP validation. Additionally, uses original user input at sink instead of normalized parsed URL.",
      "exploitation_hypothesis": "An authenticated attacker with settings:read permission can access internal services and cloud metadata endpoints. The endpoint returns HTTP status, status text, and response body (truncated to 500 characters), enabling non-blind SSRF for network reconnaissance and data exfiltration.",
      "suggested_exploit_technique": "internal_service_access",
      "confidence": "High",
      "notes": "Requires authentication and settings:read permission, but this is commonly granted to regular users. Returns truncated response body (500 chars) which is sufficient for most reconnaissance tasks. 10-second timeout. Vulnerable to same attacks as SSRF-VULN-01: cloud metadata access (http://169.254.169.254), localhost services (http://127.0.0.1:*), private networks (http://192.168.x.x, http://10.x.x.x). Critical implementation flaw: Line 8965 uses original 'url' string instead of 'parsedUrl.toString()', potentially allowing parser differential attacks."
    }
  ]
}